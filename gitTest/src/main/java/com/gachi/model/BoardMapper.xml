<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gachi.model.BoardMapper">

	<!-- 게시판 전체 내용 조회할 수 있는 SQL문장 -->
	<select id="AllList" resultType="com.gachi.model.BoardDTO">
	 select p.post_id, p.post_content, p.post_img, p.goods_id, p.created_at, p.user_id,	u.user_pic 
		from tbl_post p inner join tbl_user u on p.user_id=u.user_id
		<!-- SELECT *
		FROM (
		    SELECT 
		        p.post_id,
		        p.post_content,
		        k.like_id ,
		        p.user_id ,
		        k.post_idx,
		        p.post_img
		    FROM tbl_post p
		    left JOIN tbl_likes k ON p.post_id = k.post_idx
		) AS x
		left JOIN tbl_user u ON u.user_id = x.user_id-->
	</select>

	<!-- 게시글 하나만 조회하는 sql문장 -->
	<select id="detail" parameterType="string"
		resultType="com.gachi.model.BoardDTO">
		select * from tbl_post where num=#{num}
	</select>

	<!-- 게시글 작성 sql문장 -->
	<insert id="write" parameterType="com.gachi.model.BoardDTO">
		INSERT INTO tbl_post(post_content, post_img, goods_id, created_at, user_id)
		VALUES (#{post_content},#{post_img}, #{goods_id}, NOW(), #{user_id});
	</insert>
	
	<!-- 개인피드 가져오는 sql문장 -->
	<select id="MyList" parameterType="string" resultType="com.gachi.model.BoardDTO">
		select 	p.post_id, p.post_content, p.post_img, p.goods_id, p.created_at, p.user_id,	u.user_pic, u.user_introduction
		from tbl_post p inner join tbl_user u on p.user_id=u.user_id
	</select>
</mapper>